# Summary
`DatabaseException` is a custom checked exception used throughout the APISimCountLoader component to encapsulate database‑related error conditions. It propagates Hive/Impala JDBC failures up the call stack, enabling uniform logging and handling in higher‑level DAO classes.

# Key Components
- **class `DatabaseException`**
  - Extends `java.lang.Exception`.
  - Provides a single constructor accepting an error message string.
  - Serial version UID defined for serialization compatibility.

# Data Flow
- **Inputs:** Error message string generated by DAO or connection utilities when a JDBC operation fails.
- **Outputs:** Thrown exception object propagated to caller.
- **Side Effects:** None (exception object only carries state).
- **External Services/DBs:** None directly; used as a wrapper for failures originating from Hive/Impala JDBC interactions.

# Integrations
- **`JDBCConnection.getConnectionHive()`** – catches `SQLException` and re‑throws as `DatabaseException`.
- **`SubsCountDAO`** – declares methods with `throws DatabaseException`; catches low‑level SQL errors and wraps them.
- Any other DAO or service class in the move‑mediation pipeline that interacts with the `mnaas` Hive schema.

# Operational Risks
- **Unchecked propagation:** If callers do not handle `DatabaseException`, the thread may terminate, causing batch job failure.
  - *Mitigation:* Ensure all DAO methods declare `throws DatabaseException` and are wrapped in try‑catch blocks at the service layer with appropriate retry or alerting logic.
- **Loss of root cause:** Only the message is preserved; original `SQLException` stack trace may be lost.
  - *Mitigation:* Extend the constructor to accept a `Throwable cause` and pass it to `super(msg, cause)`.

# Usage
```java
try {
    Connection conn = jdbcConnection.getConnectionHive();
    // perform Hive query...
} catch (SQLException e) {
    throw new DatabaseException("Failed to obtain Hive connection: " + e.getMessage());
}
```
When debugging, catch `DatabaseException` at the service entry point and log `e.getMessage()`.

# Configuration
- No environment variables or external configuration files are referenced directly by this class.
- Relies on `MOVEDAO.properties` for SQL statements, but those are consumed elsewhere.

# Improvements
1. **Add cause chaining:**  
   ```java
   public DatabaseException(String msg, Throwable cause) {
       super(msg, cause);
   }
   ```
   Enables preservation of the original stack trace.

2. **Introduce error codes:**  
   Define an enum of database error categories (e.g., `CONNECTION_FAILURE`, `QUERY_TIMEOUT`) and add a field to carry the code for finer‑grained handling and monitoring.