# Summary
The `log4j.properties` file configures Log4j for the **RAReportsExport** component. It establishes a root logger at `INFO` level and attaches two appenders: a `DailyRollingFileAppender` that writes to the path defined by `${logfile.name}` and a `ConsoleAppender` (`stdout`). All log events are formatted with a common pattern and emitted to both destinations, providing persistent audit logs and real‑time console output for the MOVE‑RA‑Reports production batch jobs.

# Key Components
- **log4j.rootLogger** – Sets global log level (`INFO`) and registers the `File` and `stdout` appenders.  
- **log4j.appender.File** – `org.apache.log4j.DailyRollingFileAppender` writing to `${logfile.name}`; rotates daily.  
- **log4j.appender.File.layout** – `PatternLayout` with conversion pattern `[%-5p] %d{ISO8601} %c - %m%n`.  
- **log4j.appender.stdout** – `org.apache.log4j.ConsoleAppender` targeting `System.out`.  
- **log4j.appender.stdout.layout** – Same `PatternLayout` as file appender.

# Data Flow
| Element | Direction | Description |
|---------|-----------|-------------|
| `${logfile.name}` | Input (system property / env var) | Resolved at JVM start; defines absolute file path for daily log file. |
| Log events (Java `org.apache.log4j.Logger` calls) | Input | Generated by RAReportsExport Java classes. |
| File appender | Output | Writes formatted log lines to daily‑rolled file on local filesystem. |
| Console appender | Output | Writes formatted log lines to STDOUT (captured by batch script logs). |
| Side effects | – | File creation, file rotation, console output; no external service calls. |

# Integrations
- **RAReportsExport Java code** – Calls `Logger.getLogger(...)`; inherits configuration from this file.  
- **Batch shell scripts** – Launch Java process with `-Dlogfile.name=<path>`; console output may be redirected to script‑level log files.  
- **Production monitoring** – External log aggregation tools (e.g., Splunk, ELK) may ingest the daily log files or STDOUT streams.  

# Operational Risks
- **Missing `${logfile.name}`** – JVM start fails or logs default to current directory; mitigate by enforcing property via launch wrapper.  
- **Disk exhaustion** – Daily logs can grow unchecked; mitigate with log rotation retention policy and disk monitoring.  
- **Insufficient log level** – `INFO` may omit debug details needed for troubleshooting; mitigate by allowing runtime override (`-Dlog4j.rootLogger=DEBUG,File,stdout`).  

# Usage
```bash
# Example launch (properties file on classpath)
java -Dlogfile.name=/var/log/raexport/raexport.log \
     -Dlog4j.configuration=file:/path/to/log4j.properties \
     -cp <classpath> com.move.raexport.Main
```
*To debug logging configuration:* add `-Dlog4j.debug=true` to JVM args; Log4j will print internal configuration steps to STDOUT.

# Configuration
- **Environment variable / JVM system property:** `logfile.name` – absolute path for the rolling log file.  
- **Referenced file:** `log4j.properties` (this file) must be on the classpath or supplied via `-Dlog4j.configuration`.  

# Improvements
1. **Add log rotation retention** – Switch to `RollingFileAppender` with `MaxBackupIndex` to limit retained files.  
2. **Externalize pattern** – Define `log4j.appender.File.layout.ConversionPattern` in a separate property (e.g., `${log.pattern}`) to allow runtime pattern changes without code redeploy.